<br>
<h1>Tienda</h1>
<p> </p>
<p-button styleClass="ui-button-warning" label="Volver" (onClick)="volver() " ></p-button>
<p> </p>
<p-tabView>
  <p-tabPanel header="Tienda">
    <br>
    <p-card header="Cabecera carrito">
      <form #compraFormulario = "ngForm">
        <div class="ui-g">
          <div class="ui-g-6" >
            <label for="nombre">Nombre: </label>
            <input id="nombre"
                   type="text"
                   name="nombre"
                   required
                   disabled=true
                   placeholder="{{nombre}} {{apellido}}"
                   >
          </div>
          <div class="ui-g-6" >
            <label for="direccion">Dirección: </label>
            <input id="direccion"
                   type="text"
                   placeholder="Direccion"
                   name="direccion"
                   required
                   minlength="15"
                   maxlength="200"
                   [(ngModel)]="direccion"

                   #direccionInput = "ngModel">
          </div>
          <div *ngIf="direccionInput.touched && direccionInput.dirty && direccionInput.errors">
            <p *ngIf="direccionInput.errors.required ">
              Este campo es requerido.
            </p>
            <p *ngIf="direccionInput.errors.minlength ">
              llenar con un minimo de 15 caracteres
            </p>
            <p *ngIf="direccionInput.errors.maxlength ">
              Llenar con un maximo de 200 caracteres
            </p>
          </div>
        </div>
        <br>
        <div class="ui-g">
          <div class="ui-g-4">
            <label for="fecha">Fecha: </label>
            <input id="fecha"
                   type="text"
                   placeholder=""
                   name="fecha"
                   required
                   [(ngModel)]="fecha"
                   #fechaI = "ngModel"
            >
            <div *ngIf="fechaI.touched && fechaI.dirty && fechaI.errors">
              <p *ngIf="fechaI.errors.required ">
                Este campo es requerido.
              </p>
            </div>
          </div>
          <div class="ui-g-4">
            <label for="estado">Estado: </label>
            <input id="estado"
                   type="text"
                   required
                   placeholder="{{estado}}"
                   name="estado"
                   disabled = true
                   >
          </div>
          <div class="ui-g-4">
            <label for="total">Total: </label>
            <input id="total"
                   type="number"
                   required
                   placeholder="{{total | currency}}"
                   name="total"
                   disabled=true
                   min="0"
                   max="1000000"
                   [(ngModel)]="total"

                   #totalInput = "ngModel">
          </div>
          <div *ngIf="totalInput.touched && totalInput.dirty && totalInput.errors">
            <p *ngIf="totalInput.errors.required ">
              Este campo es requerido.
            </p>
          </div>
        </div>
        <br>
        <div class="ui-g">
          <div class="ui-g-5"></div>
          <div class="ui-g-2">
            <p-button label="COMPRAR" styleClass="ui-button-success"
                      [disabled]="compraFormulario.invalid || estadoBoolean"
                      (onClick)="guardarCabecera()"></p-button>
          </div>
          <div class="ui-g-5"></div>
        </div>
      </form>
    </p-card>

    <br>

    <p-card header="Detalle carrito">
      <br>
      <p-table [value]="detalleTemporal"
               [paginator]="true"
               [rows]="5">
        <ng-template pTemplate="caption">
          <p-button label="Añadir"
                    [disabled]=" compraBoolean"
                    (onClick)="mostrarMedicamento()"></p-button>
        </ng-template>
        <ng-template pTemplate="header">
          <tr>
            <th>Medicamento</th>
            <th>Precio</th>
            <th>Cantidad</th>
            <th>Subtotal</th>
            <th>Acciones</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-medicamento let-rowIndex="rowIndex">
          <tr>

            <td>{{medicamento.nombre}}</td>
            <td>{{medicamento.precio | currency}}</td>
            <td>
              <input id="cantidad"
                     type="number"
                     min="0"
                     max="100"
                     name="cantidad"
                     required
                     placeholder="{{medicamento.cantidad}}"

                     [(ngModel)]="medicamento.cantidad"
                     (ngModelChange)="calcularSubtotal(medicamento, rowIndex)"
                     #cantidadInput = "ngModel"
              >
              <div *ngIf="cantidadInput.touched && cantidadInput.dirty && cantidadInput.errors">
                <p *ngIf="cantidadInput.errors.required ">
                  Este campo es requerido.
                </p>
                <p *ngIf="cantidadInput.errors.min">
                  llenar con un numero mayor a 0
                </p>
                <p *ngIf="cantidadInput.errors.max ">
                  llenar con un numero menor a 1000
                </p>
              </div>

            </td>
            <td>
              {{medicamento.subtotal | currency}}
            </td>
            <td>
              <p-button styleClass="ui-button-danger" label="Eliminar" (onClick)="eliminar(rowIndex) " ></p-button>
            </td>

          </tr>
        </ng-template>
      </p-table>
    </p-card>
  </p-tabPanel>
</p-tabView>


